<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="../../favicon.ico">

  <title>Starter Template for Bootstrap</title>

  <!-- Bootstrap core CSS -->
  <link href="../bootstrap4/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="../css/starter-template.css" rel="stylesheet">
  <!-- Leaflet css -->
  <link rel="stylesheet" href="../node_modules/leaflet/dist/leaflet.css"/>
  <!-- leaflet js file -->
  <script src= "../node_modules/leaflet/dist/leaflet.js"></script>
  <!-- mapbox file -->
  <script src='https://api.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.css' rel='stylesheet' />
  <!-- Ant Line -->
  <!-- <link rel="stylesheet" href="../node_modules/leaflet-ant-path/dist/leaflet.css"/> -->
  <script src= "../node_modules/leaflet-ant-path/dist/leaflet-ant-path.js"></script>


</head>


<body>

  <!-- <nav class="navbar navbar-toggleable-md navbar-inverse bg-inverse fixed-top">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
  <span class="navbar-toggler-icon"></span>
</button>
<a class="navbar-brand" href="#">Navbar</a>

<div class="collapse navbar-collapse" id="navbarsExampleDefault">
<ul class="navbar-nav mr-auto">
<li class="nav-item active">
<a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="#">Link</a>
</li>
<li class="nav-item">
<a class="nav-link disabled" href="#">Disabled</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>
<div class="dropdown-menu" aria-labelledby="dropdown01">
<a class="dropdown-item" href="#">Action</a>
<a class="dropdown-item" href="#">Another action</a>
<a class="dropdown-item" href="#">Something else here</a>
</div>
</li>
</ul>
<form class="form-inline my-2 my-lg-0">
<input class="form-control mr-sm-2" type="text" placeholder="Search">
<button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
</form>
</div>
</nav> -->

<div >

  <div class="starter-template">
    <div id="mapid"> </div>


  </div>

</div><!-- /.container -->


<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="../bootstrap4/dist/js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="../bootstrap4/docs/assets/js/ie10-viewport-bug-workaround.js"></script>
<script type="text/javascript">





</script>


<script type="text/javascript">
//When the Window finishes loading...

function getColor(num){
  var num = parseInt(num);
  if( num <50){
    return "#14D812"
  }
  if( num < 150){
    return "#70D10D"
  }
  if( num < 400){
    return "#CACB08"
  }
  if( num < 800){
    return "#C56604"
  }
  else{
    return "#BF0100"
  }

}
function getClass(){
  var ran= Math.floor(Math.random() * 9);
  if(ran<1){
    return "pulse1";
  }
  if(ran<2){
    return "pulse2";

  }
  if(ran<3){
    return "pulse3";

  }
  if(ran<4){
    return "pulse3";

  }
  if(ran<5){
    return "pulse3";

  }
  if(ran<6){
    return "pulse3";

  }
  if(ran<7){
    return "pulse3";
  }
  else{
    return "pulse4";

  }



}


$(window).on ('load', function () {

  var mymap = L.map('mapid').setView([15.53499, -7.03406], 7);
  L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
    maxZoom: 18,
    id: 'mapbox.dark',
    accessToken: 'pk.eyJ1IjoiYXlhbmV6IiwiYSI6ImNqNHloOXAweTFveWwzM3A4M3FkOWUzM2UifQ.GfClkT4QxlFDC_xiI37x3Q'
  }).addTo(mymap);

  $.ajax({
    url: 'samplecsv.php',
    dataType: "json",
    success:function(data){
      $.each(data, function(){

        var circle = L.circle([this.lat, this.lng], {
          stroke: false,
          fillColor: getColor(this.num),
          fillOpacity: 0.5,
          radius: 2000,
          className: getClass()
        }).addTo(mymap);

        circle.bindPopup(this.name + "<br>" + this.num );


        var circleT = L.circle([this.tlat, this.tlng], {
          stroke: false,
          fillColor: "#fff",
          fillOpacity: 0.5,
          radius: 1500,
          className:"strobe"
        }).addTo(mymap);


        if(  Math.abs(Math.abs(parseFloat(this.lng)) -Math.abs(parseFloat(this.tlng)))<.4 && Math.abs(Math.abs(parseFloat(this.lat)) -Math.abs(parseFloat(this.tlat)))<.4){
          var latlngs = [
            [this.lat, this.lng],
            [this.tlat, this.tlng]
          ];

          var antPolyline = L.polyline.antPath(latlngs, {
            color: 'red',
            weight: .2,
            opacity: .4
          });
          antPolyline.addTo(mymap);

        }



        // var polyline = L.polyline(latlngs, {
        //   color: 'red',
        //   weight: .00118,
        //   opacity: .4
        //
        //
        // }).addTo(mymap);


      });
    }
  });

});



</script>
</body>
</html>
